-------------------------------------------------------------------------------
Test set: com.example.FirebaseAdminTest
-------------------------------------------------------------------------------
Tests run: 4, Failures: 0, Errors: 3, Skipped: 0, Time elapsed: 0.262 s <<< FAILURE! -- in com.example.FirebaseAdminTest
com.example.FirebaseAdminTest.test2AuthGetUsers -- Time elapsed: 0.029 s <<< ERROR!
com.google.firebase.auth.FirebaseAuthException: Unknown error while making a remote service call: Unexpected error refreshing access token
	at com.google.firebase.auth.internal.AuthErrorHandler.createException(AuthErrorHandler.java:122)
	at com.google.firebase.auth.internal.AuthErrorHandler.createException(AuthErrorHandler.java:35)
	at com.google.firebase.internal.AbstractHttpErrorHandler.handleIOException(AbstractHttpErrorHandler.java:63)
	at com.google.firebase.internal.ErrorHandlingHttpClient.createHttpRequest(ErrorHandlingHttpClient.java:142)
	at com.google.firebase.internal.ErrorHandlingHttpClient.send(ErrorHandlingHttpClient.java:93)
	at com.google.firebase.auth.internal.AuthHttpClient.sendRequest(AuthHttpClient.java:75)
	at com.google.firebase.auth.internal.AuthHttpClient.sendRequest(AuthHttpClient.java:69)
	at com.google.firebase.auth.FirebaseUserManager.listUsers(FirebaseUserManager.java:202)
	at com.google.firebase.auth.ListUsersPage$DefaultUserSource.fetch(ListUsersPage.java:201)
	at com.google.firebase.auth.ListUsersPage$Factory.create(ListUsersPage.java:261)
	at com.google.firebase.auth.AbstractFirebaseAuth$10.execute(AbstractFirebaseAuth.java:684)
	at com.google.firebase.auth.AbstractFirebaseAuth$10.execute(AbstractFirebaseAuth.java:681)
	at com.google.firebase.internal.CallableOperation.call(CallableOperation.java:36)
	at com.google.firebase.auth.AbstractFirebaseAuth.listUsers(AbstractFirebaseAuth.java:646)
	at com.example.FirebaseAdminTest.test2AuthGetUsers(FirebaseAdminTest.java:41)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: java.io.IOException: Unexpected error refreshing access token
	at com.google.auth.oauth2.OAuth2Credentials.unwrapDirectFuture(OAuth2Credentials.java:325)
	at com.google.auth.oauth2.OAuth2Credentials.getRequestMetadata(OAuth2Credentials.java:183)
	at com.google.auth.http.HttpCredentialsAdapter.initialize(HttpCredentialsAdapter.java:96)
	at com.google.firebase.internal.FirebaseRequestInitializer.initialize(FirebaseRequestInitializer.java:55)
	at com.google.api.client.http.HttpRequestFactory.buildRequest(HttpRequestFactory.java:91)
	at com.google.firebase.internal.HttpRequestInfo.newHttpRequest(HttpRequestInfo.java:105)
	at com.google.firebase.internal.ErrorHandlingHttpClient.createHttpRequest(ErrorHandlingHttpClient.java:138)
	... 14 more
Caused by: java.lang.NoClassDefFoundError: com/google/auth/CredentialTypeForMetrics
	at com.google.auth.oauth2.UserCredentials.getMetricsCredentialType(UserCredentials.java:104)
	at com.google.auth.oauth2.UserCredentials.doRefreshAccessToken(UserCredentials.java:278)
	at com.google.auth.oauth2.UserCredentials.refreshAccessToken(UserCredentials.java:185)
	at com.google.auth.oauth2.OAuth2Credentials$1.call(OAuth2Credentials.java:270)
	at com.google.auth.oauth2.OAuth2Credentials$1.call(OAuth2Credentials.java:267)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at com.google.auth.oauth2.OAuth2Credentials$RefreshTask.run(OAuth2Credentials.java:635)
	at com.google.common.util.concurrent.DirectExecutor.execute(DirectExecutor.java:31)
	at com.google.auth.oauth2.OAuth2Credentials$AsyncRefreshResult.executeIfNew(OAuth2Credentials.java:582)
	at com.google.auth.oauth2.OAuth2Credentials.asyncFetch(OAuth2Credentials.java:233)
	... 20 more
Caused by: java.lang.ClassNotFoundException: com.google.auth.CredentialTypeForMetrics
	at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)
	at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)
	at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:520)
	... 30 more

com.example.FirebaseAdminTest.test3FirestoreReadWrite -- Time elapsed: 0.040 s <<< ERROR!
java.lang.NoClassDefFoundError: com/google/auth/ApiKeyCredentials
	at com.google.cloud.firestore.spi.v1.GrpcFirestoreRpc.<init>(GrpcFirestoreRpc.java:126)
	at com.google.cloud.firestore.FirestoreOptions$DefaultFirestoreRpcFactory.create(FirestoreOptions.java:92)
	at com.google.cloud.firestore.FirestoreOptions$DefaultFirestoreRpcFactory.create(FirestoreOptions.java:84)
	at com.google.cloud.ServiceOptions.getRpc(ServiceOptions.java:602)
	at com.google.cloud.firestore.FirestoreOptions.getFirestoreRpc(FirestoreOptions.java:413)
	at com.google.cloud.firestore.FirestoreImpl.<init>(FirestoreImpl.java:78)
	at com.google.cloud.firestore.FirestoreOptions$DefaultFirestoreFactory.create(FirestoreOptions.java:75)
	at com.google.cloud.firestore.FirestoreOptions$DefaultFirestoreFactory.create(FirestoreOptions.java:68)
	at com.google.cloud.ServiceOptions.getService(ServiceOptions.java:582)
	at com.google.firebase.cloud.FirestoreClient.<init>(FirestoreClient.java:55)
	at com.google.firebase.cloud.FirestoreClient.<init>(FirestoreClient.java:32)
	at com.google.firebase.cloud.FirestoreClient$FirestoreInstances.lambda$get$0(FirestoreClient.java:150)
	at java.base/java.util.HashMap.computeIfAbsent(HashMap.java:1220)
	at java.base/java.util.Collections$SynchronizedMap.computeIfAbsent(Collections.java:2760)
	at com.google.firebase.cloud.FirestoreClient$FirestoreInstances.get(FirestoreClient.java:150)
	at com.google.firebase.cloud.FirestoreClient.getInstance(FirestoreClient.java:121)
	at com.google.firebase.cloud.FirestoreClient.getFirestore(FirestoreClient.java:98)
	at com.google.firebase.cloud.FirestoreClient.getFirestore(FirestoreClient.java:83)
	at com.example.FirebaseAdminTest.test3FirestoreReadWrite(FirebaseAdminTest.java:53)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: java.lang.ClassNotFoundException: com.google.auth.ApiKeyCredentials
	at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)
	at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)
	at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:520)
	... 22 more

com.example.FirebaseAdminTest.test4CreateCustomToken -- Time elapsed: 0.028 s <<< ERROR!
java.lang.IllegalStateException: Failed to initialize FirebaseTokenFactory. Make sure to initialize the SDK with service account credentials or specify a service account ID with iam.serviceAccounts.signBlob permission. Please refer to https://firebase.google.com/docs/auth/admin/create-custom-tokens for more details on creating custom tokens.
	at com.google.firebase.auth.FirebaseTokenUtils.createTokenFactory(FirebaseTokenUtils.java:68)
	at com.google.firebase.auth.AbstractFirebaseAuth$33.get(AbstractFirebaseAuth.java:1821)
	at com.google.firebase.auth.AbstractFirebaseAuth$33.get(AbstractFirebaseAuth.java:1818)
	at com.google.firebase.auth.AbstractFirebaseAuth$29.get(AbstractFirebaseAuth.java:1768)
	at com.google.common.base.Suppliers$NonSerializableMemoizingSupplier.get(Suppliers.java:200)
	at com.google.firebase.auth.AbstractFirebaseAuth.createCustomTokenOp(AbstractFirebaseAuth.java:168)
	at com.google.firebase.auth.AbstractFirebaseAuth.createCustomToken(AbstractFirebaseAuth.java:130)
	at com.google.firebase.auth.AbstractFirebaseAuth.createCustomToken(AbstractFirebaseAuth.java:88)
	at com.example.FirebaseAdminTest.test4CreateCustomToken(FirebaseAdminTest.java:76)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: java.io.IOException: Unknown exception in request
	at com.google.firebase.internal.ApacheHttp2Request.execute(ApacheHttp2Request.java:134)
	at com.google.api.client.http.HttpRequest.execute(HttpRequest.java:1012)
	at com.google.firebase.auth.internal.CryptoSigners.discoverServiceAccountId(CryptoSigners.java:188)
	at com.google.firebase.auth.internal.CryptoSigners.getCryptoSigner(CryptoSigners.java:178)
	at com.google.firebase.auth.FirebaseTokenUtils.createTokenFactory(FirebaseTokenUtils.java:65)
	... 11 more
Caused by: java.util.concurrent.ExecutionException: java.net.UnknownHostException: metadata.google.internal: nodename nor servname provided, or not known
	at org.apache.hc.core5.concurrent.BasicFuture.getResult(BasicFuture.java:72)
	at org.apache.hc.core5.concurrent.BasicFuture.get(BasicFuture.java:85)
	at com.google.firebase.internal.ApacheHttp2Request.execute(ApacheHttp2Request.java:123)
	... 15 more
Caused by: java.net.UnknownHostException: metadata.google.internal: nodename nor servname provided, or not known
	at java.base/java.net.Inet6AddressImpl.lookupAllHostAddr(Native Method)
	at java.base/java.net.InetAddress$PlatformNameService.lookupAllHostAddr(InetAddress.java:933)
	at java.base/java.net.InetAddress.getAddressesFromNameService(InetAddress.java:1519)
	at java.base/java.net.InetAddress$NameServiceAddresses.get(InetAddress.java:852)
	at java.base/java.net.InetAddress.getAllByName0(InetAddress.java:1509)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1367)
	at java.base/java.net.InetAddress.getAllByName(InetAddress.java:1301)
	at org.apache.hc.client5.http.SystemDefaultDnsResolver.resolve(SystemDefaultDnsResolver.java:45)
	at org.apache.hc.client5.http.impl.nio.MultihomeIOSessionRequester.connect(MultihomeIOSessionRequester.java:113)
	at org.apache.hc.client5.http.impl.nio.DefaultAsyncClientConnectionOperator.connect(DefaultAsyncClientConnectionOperator.java:100)
	at org.apache.hc.client5.http.impl.nio.PoolingAsyncClientConnectionManager.connect(PoolingAsyncClientConnectionManager.java:449)
	at org.apache.hc.client5.http.impl.async.InternalHttpAsyncExecRuntime.connectEndpoint(InternalHttpAsyncExecRuntime.java:216)
	at org.apache.hc.client5.http.impl.async.AsyncConnectExec.proceedToNextHop(AsyncConnectExec.java:210)
	at org.apache.hc.client5.http.impl.async.AsyncConnectExec.access$000(AsyncConnectExec.java:91)
	at org.apache.hc.client5.http.impl.async.AsyncConnectExec$1.completed(AsyncConnectExec.java:162)
	at org.apache.hc.client5.http.impl.async.AsyncConnectExec$1.completed(AsyncConnectExec.java:151)
	at org.apache.hc.client5.http.impl.async.InternalHttpAsyncExecRuntime$1.completed(InternalHttpAsyncExecRuntime.java:119)
	at org.apache.hc.client5.http.impl.async.InternalHttpAsyncExecRuntime$1.completed(InternalHttpAsyncExecRuntime.java:110)
	at org.apache.hc.core5.concurrent.BasicFuture.completed(BasicFuture.java:123)
	at org.apache.hc.client5.http.impl.nio.PoolingAsyncClientConnectionManager$3$1.leaseCompleted(PoolingAsyncClientConnectionManager.java:328)
	at org.apache.hc.client5.http.impl.nio.PoolingAsyncClientConnectionManager$3$1.completed(PoolingAsyncClientConnectionManager.java:313)
	at org.apache.hc.client5.http.impl.nio.PoolingAsyncClientConnectionManager$3$1.completed(PoolingAsyncClientConnectionManager.java:274)
	at org.apache.hc.core5.concurrent.BasicFuture.completed(BasicFuture.java:123)
	at org.apache.hc.core5.pool.StrictConnPool.fireCallbacks(StrictConnPool.java:402)
	at org.apache.hc.core5.pool.StrictConnPool.lease(StrictConnPool.java:220)
	at org.apache.hc.client5.http.impl.nio.PoolingAsyncClientConnectionManager$3.<init>(PoolingAsyncClientConnectionManager.java:271)
	at org.apache.hc.client5.http.impl.nio.PoolingAsyncClientConnectionManager.lease(PoolingAsyncClientConnectionManager.java:266)
	at org.apache.hc.client5.http.impl.async.InternalHttpAsyncExecRuntime.acquireEndpoint(InternalHttpAsyncExecRuntime.java:105)
	at org.apache.hc.client5.http.impl.async.AsyncConnectExec.execute(AsyncConnectExec.java:150)
	at org.apache.hc.client5.http.impl.async.AsyncExecChainElement.execute(AsyncExecChainElement.java:54)
	at org.apache.hc.client5.http.impl.async.AsyncProtocolExec.internalExecute(AsyncProtocolExec.java:207)
	at org.apache.hc.client5.http.impl.async.AsyncProtocolExec.execute(AsyncProtocolExec.java:172)
	at org.apache.hc.client5.http.impl.async.AsyncExecChainElement.execute(AsyncExecChainElement.java:54)
	at org.apache.hc.client5.http.impl.async.InternalAbstractHttpAsyncClient.executeImmediate(InternalAbstractHttpAsyncClient.java:372)
	at org.apache.hc.client5.http.impl.async.InternalAbstractHttpAsyncClient.lambda$doExecute$0(InternalAbstractHttpAsyncClient.java:228)
	at org.apache.hc.core5.http.nio.support.BasicRequestProducer.sendRequest(BasicRequestProducer.java:93)
	at org.apache.hc.client5.http.impl.async.InternalAbstractHttpAsyncClient.doExecute(InternalAbstractHttpAsyncClient.java:203)
	at org.apache.hc.client5.http.impl.async.CloseableHttpAsyncClient.execute(CloseableHttpAsyncClient.java:97)
	at org.apache.hc.client5.http.impl.async.CloseableHttpAsyncClient.execute(CloseableHttpAsyncClient.java:107)
	at org.apache.hc.client5.http.impl.async.CloseableHttpAsyncClient.execute(CloseableHttpAsyncClient.java:116)
	at com.google.firebase.internal.ApacheHttp2Request.execute(ApacheHttp2Request.java:93)
	... 15 more

